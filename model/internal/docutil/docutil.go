//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_a "errors";_eg "fmt";_b "github.com/laduygaga/unipdf/v3/common";_c "github.com/laduygaga/unipdf/v3/core";);type Content struct{Stream *_c .PdfObjectStream ;_bdc int ;_dbad Page ;};func (_eab *Document )AddStream (stream *_c .PdfObjectStream ){for _ ,_ede :=range _eab .Objects {if _ede ==stream {return ;
};};_eab .Objects =append (_eab .Objects ,stream );};func (_de *OutputIntents )Add (oi _c .PdfObject )error {_dd ,_ed :=oi .(*_c .PdfObjectDictionary );if !_ed {return _a .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _fc ,_cb :=_c .GetStream (_dd .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_cb {_de ._dge .Objects =append (_de ._dge .Objects ,_fc );};_cd ,_dc :=oi .(*_c .PdfIndirectObject );if !_dc {_cd =_c .MakeIndirectObject (oi );
};if _de ._bed ==nil {_de ._bed =_c .MakeArray (_cd );}else {_de ._bed .Append (_cd );};_de ._dge .Objects =append (_de ._dge .Objects ,_cd );return nil ;};func (_egb *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _aef :=_egb .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
_aef !=nil {for _dg ,_fd :=range _egb ._bg .Objects {if _fd ==_aef {if outputIntents ._fa ==_aef {return ;};_egb ._bg .Objects =append (_egb ._bg .Objects [:_dg ],_egb ._bg .Objects [_dg +1:]...);break ;};};};_efd :=outputIntents ._fa ;if _efd ==nil {_efd =_c .MakeIndirectObject (outputIntents ._bed );
};_egb .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_efd );_egb ._bg .Objects =append (_egb ._bg .Objects ,_efd );};func (_db *Catalog )GetMarkInfo ()(*_c .PdfObjectDictionary ,bool ){_ada ,_ab :=_c .GetDict (_db .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));
return _ada ,_ab ;};func (_bgd *Catalog )GetPages ()([]Page ,bool ){_ag ,_f :=_c .GetDict (_bgd .Object .Get ("\u0050\u0061\u0067e\u0073"));if !_f {return nil ,false ;};_bd ,_ec :=_c .GetArray (_ag .Get ("\u004b\u0069\u0064\u0073"));if !_ec {return nil ,false ;
};_g :=make ([]Page ,_bd .Len ());for _bc ,_gb :=range _bd .Elements (){_bgdc ,_gd :=_c .GetDict (_gb );if !_gd {continue ;};_g [_bc ]=Page {Object :_bgdc ,_bde :_bc +1,_agg :_bgd ._bg };};return _g ,true ;};func (_efe *Document )GetPages ()([]Page ,bool ){_agc ,_af :=_efe .FindCatalog ();
if !_af {return nil ,false ;};return _agc .GetPages ();};type OutputIntents struct{_bed *_c .PdfObjectArray ;_dge *Document ;_fa *_c .PdfIndirectObject ;};func (_ege *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_dge :_ege ._bg }};
func (_ee *Catalog )SetMetadata (data []byte )error {_ea ,_d :=_c .MakeStream (data ,nil );if _d !=nil {return _d ;};_ea .Set ("\u0054\u0079\u0070\u0065",_c .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));_ea .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_c .MakeName ("\u0058\u004d\u004c"));
_ee .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_ea );_ee ._bg .Objects =append (_ee ._bg .Objects ,_ea );return nil ;};func (_ecc *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_cf :=_ecc .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
if _cf ==nil {return nil ,false ;};_bb ,_gbe :=_c .GetIndirect (_cf );if !_gbe {return nil ,false ;};_fdd ,_efg :=_c .GetArray (_bb .PdfObject );if !_efg {return nil ,false ;};return &OutputIntents {_fa :_bb ,_bed :_fdd ,_dge :_ecc ._bg },true ;};type ImageSMask struct{Image *Image ;
Stream *_c .PdfObjectStream ;};func (_eeb *OutputIntents )Get (i int )(OutputIntent ,bool ){if _eeb ._bed ==nil {return OutputIntent {},false ;};if i >=_eeb ._bed .Len (){return OutputIntent {},false ;};_gf :=_eeb ._bed .Get (i );_aba ,_ddd :=_c .GetIndirect (_gf );
if !_ddd {_bcg ,_aa :=_c .GetDict (_gf );return OutputIntent {Object :_bcg },_aa ;};_ecd ,_eeg :=_c .GetDict (_aba .PdfObject );return OutputIntent {Object :_ecd },_eeg ;};type Image struct{Name string ;Width int ;Height int ;Colorspace _c .PdfObjectName ;
ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_c .PdfObjectStream ;};func (_egbb Page )GetContents ()([]Content ,bool ){_ff ,_dcd :=_c .GetArray (_egbb .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_dcd {_abe ,_cfd :=_c .GetStream (_egbb .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_cfd {return nil ,false ;};return []Content {{Stream :_abe ,_dbad :_egbb ,_bdc :0}},true ;};_egc :=make ([]Content ,_ff .Len ());for _eccd ,_dba :=range _ff .Elements (){_dee ,_dbg :=_c .GetStream (_dba );if !_dbg {continue ;};_egc [_eccd ]=Content {Stream :_dee ,_dbad :_egbb ,_bdc :_eccd };
};return _egc ,true ;};func (_ece *Document )AddIndirectObject (indirect *_c .PdfIndirectObject ){for _ ,_ead :=range _ece .Objects {if _ead ==indirect {return ;};};_ece .Objects =append (_ece .Objects ,indirect );};func (_fbb Page )GetResources ()(*_c .PdfObjectDictionary ,bool ){return _c .GetDict (_fbb .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
};func (_fbd Content )GetData ()([]byte ,error ){_cge ,_gcfa :=_c .NewEncoderFromStream (_fbd .Stream );if _gcfa !=nil {return nil ,_gcfa ;};_gee ,_gcfa :=_cge .DecodeStream (_fbd .Stream );if _gcfa !=nil {return nil ,_gcfa ;};return _gee ,nil ;};func (_ce *Catalog )SetVersion (){_ce .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_c .MakeName (_eg .Sprintf ("\u0025\u0064\u002e%\u0064",_ce ._bg .Version .Major ,_ce ._bg .Version .Minor )));
};func (_ef *Catalog )GetMetadata ()(*_c .PdfObjectStream ,bool ){_ad ,_ae :=_c .GetStream (_ef .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));return _ad ,_ae ;};func (_be *Catalog )HasMetadata ()bool {_eb :=_be .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");
return _eb !=nil ;};func (_gaa Page )FindXObjectForms ()[]*_c .PdfObjectStream {_gdge ,_fbf :=_gaa .GetResourcesXObject ();if !_fbf {return nil ;};_gfg :=map[*_c .PdfObjectStream ]struct{}{};var _fab func (_eae *_c .PdfObjectDictionary ,_eaeg map[*_c .PdfObjectStream ]struct{});
_fab =func (_edd *_c .PdfObjectDictionary ,_bag map[*_c .PdfObjectStream ]struct{}){for _ ,_ecb :=range _edd .Keys (){_egf ,_ded :=_c .GetStream (_edd .Get (_ecb ));if !_ded {continue ;};if _ ,_afee :=_bag [_egf ];_afee {continue ;};_cdf ,_dcf :=_c .GetName (_egf .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));
if !_dcf ||_cdf .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_bag [_egf ]=struct{}{};_age ,_dcf :=_c .GetDict (_egf .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));if !_dcf {continue ;};_fbg ,_deg :=_c .GetDict (_age .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));
if _deg {_fab (_fbg ,_bag );};};};_fab (_gdge ,_gfg );var _egfe []*_c .PdfObjectStream ;for _caa :=range _gfg {_egfe =append (_egfe ,_caa );};return _egfe ;};func (_ceb *Page )Number ()int {return _ceb ._bde };func (_fbc Page )FindXObjectImages ()([]*Image ,error ){_cfb ,_edf :=_fbc .GetResourcesXObject ();
if !_edf {return nil ,nil ;};var _bbd []*Image ;var _afd error ;_fac :=map[*_c .PdfObjectStream ]int {};_aae :=map[*_c .PdfObjectStream ]struct{}{};var _aaf int ;for _ ,_bf :=range _cfb .Keys (){_gde ,_adc :=_c .GetStream (_cfb .Get (_bf ));if !_adc {continue ;
};if _ ,_gda :=_fac [_gde ];_gda {continue ;};_gded ,_afe :=_c .GetName (_gde .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_afe ||_gded .String ()!="\u0049\u006d\u0061g\u0065"{continue ;};_ca :=Image {BitsPerComponent :8,Stream :_gde ,Name :string (_bf )};
if _ca .Colorspace ,_afd =_eag (_gde .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));_afd !=nil {_b .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_afd );
continue ;};if _efb ,_gcf :=_c .GetIntVal (_gde .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));_gcf {_ca .BitsPerComponent =_efb ;};if _gdc ,_aac :=_c .GetIntVal (_gde .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));
_aac {_ca .Width =_gdc ;};if _cfc ,_cbd :=_c .GetIntVal (_gde .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));_cbd {_ca .Height =_cfc ;};if _cbe ,_ebc :=_c .GetStream (_gde .Get ("\u0053\u004d\u0061s\u006b"));_ebc {_ca .SMask =&ImageSMask {Image :&_ca ,Stream :_cbe };
_aae [_cbe ]=struct{}{};};switch _ca .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_ca .ColorComponents =3;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_ca .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_ca .ColorComponents =4;
default:_ca .ColorComponents =-1;};_fac [_gde ]=_aaf ;_bbd =append (_bbd ,&_ca );_aaf ++;};var _da []int ;for _ ,_cfdb :=range _bbd {if _cfdb .SMask !=nil {_cg ,_eadd :=_fac [_cfdb .SMask .Stream ];if _eadd {_da =append (_da ,_cg );};};};_cba :=make ([]*Image ,len (_bbd )-len (_da ));
_aaf =0;_gbf :for _cc ,_fcb :=range _bbd {for _ ,_fde :=range _da {if _cc ==_fde {continue _gbf ;};};_cba [_aaf ]=_fcb ;_aaf ++;};return _bbd ,nil ;};type OutputIntent struct{Object *_c .PdfObjectDictionary ;};type Page struct{_bde int ;Object *_c .PdfObjectDictionary ;
_agg *Document ;};func (_eea *Content )SetData (data []byte )error {_bce ,_fba :=_c .MakeStream (data ,_c .NewFlateEncoder ());if _fba !=nil {return _fba ;};_dedc ,_abab :=_c .GetArray (_eea ._dbad .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_abab &&_eea ._bdc ==0{_eea ._dbad .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_bce );}else {if _fba =_dedc .Set (_eea ._bdc ,_bce );_fba !=nil {return _fba ;};};_eea ._dbad ._agg .Objects =append (_eea ._dbad ._agg .Objects ,_bce );
return nil ;};func _eag (_ge _c .PdfObject )(_c .PdfObjectName ,error ){var _edb *_c .PdfObjectName ;var _egg *_c .PdfObjectArray ;if _df ,_fg :=_ge .(*_c .PdfIndirectObject );_fg {if _egd ,_fb :=_df .PdfObject .(*_c .PdfObjectArray );_fb {_egg =_egd ;
}else if _bgf ,_abg :=_df .PdfObject .(*_c .PdfObjectName );_abg {_edb =_bgf ;};}else if _fce ,_abb :=_ge .(*_c .PdfObjectArray );_abb {_egg =_fce ;}else if _cee ,_bge :=_ge .(*_c .PdfObjectName );_bge {_edb =_cee ;};if _edb !=nil {switch *_edb {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_edb ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_edb ,nil ;};};if _egg !=nil &&_egg .Len ()> 0{if _dca ,_ba :=_egg .Get (0).(*_c .PdfObjectName );_ba {switch *_dca {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _egg .Len ()==1{return *_dca ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_dca ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_dca ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_dca ,nil ;};};};return "",nil ;};func (_bbe *Document )FindCatalog ()(*Catalog ,bool ){var _bbf *_c .PdfObjectDictionary ;for _ ,_ac :=range _bbe .Objects {_cef ,_cdg :=_c .GetDict (_ac );
if !_cdg {continue ;};if _dgf ,_gc :=_c .GetName (_cef .Get ("\u0054\u0079\u0070\u0065"));_gc &&*_dgf =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_bbf =_cef ;break ;};};if _bbf ==nil {return nil ,false ;};return &Catalog {Object :_bbf ,_bg :_bbe },true ;
};type Document struct{ID [2]string ;Version _c .Version ;Objects []_c .PdfObject ;Info _c .PdfObject ;Crypt *_c .PdfCrypt ;UseHashBasedID bool ;};type Catalog struct{Object *_c .PdfObjectDictionary ;_bg *Document ;};func (_cbb Page )GetResourcesXObject ()(*_c .PdfObjectDictionary ,bool ){_dce ,_dfa :=_cbb .GetResources ();
if !_dfa {return nil ,false ;};return _c .GetDict (_dce .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};func (_gbb *Catalog )SetMarkInfo (mi _c .PdfObject ){_ecf :=_c .MakeIndirectObject (mi );_gbb .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_ecf );
_gbb ._bg .Objects =append (_gbb ._bg .Objects ,_ecf );};func (_eca *OutputIntents )Len ()int {return _eca ._bed .Len ()};